---
title: "JS执行过程"
date: 2021-12-02T23:39:19+08:00
draft: true
tags:
 - 
---
## 变量提升 (Hoisting)

#### 变量的声明和赋值

![img](/Users/zxd/Documents/00-typora-md/知识点/2.执行上下文 作用域 闭包.assets/ec882f2d9deec26ce168b409f274533c.png)



#### 函数的声明和赋值

![img](/Users/zxd/Documents/00-typora-md/知识点/2.执行上下文 作用域 闭包.assets/611c09ab995b9b608d9c0db193266777.png)



- 变量提升，是指**在 JavaScript 代码执行过程中，JavaScript 引擎把变量的声明部分和函数的声明部分提升到代码开头的“行为”。**
- 变量被提升后，会给变量设置默认值 **undefined**

## JavaScript 代码的执行流程

- **实际上变量和函数声明在代码里的位置是不会改变的，而且是在编译阶段被 JavaScript 引擎放入内存中**
- 一段 JavaScript 代码在执行之前需要被 JavaScript 引擎编译，编译完成之后，才会进入执行阶段

```js
// JS执行流程
一段JS代码  --> 编译阶段 -- > 执行阶段
```

![img](/Users/zxd/Documents/00-typora-md/知识点/2.执行上下文 作用域 闭包.assets/649c6e3b5509ffd40e13ce9c91b3d91e.png)

#### 编译阶段

输入一段代码，经过编译后，会生成两部分内容：执行上下文（Execution context）和可执行代码。

---



##### 执行上下文

![img](/Users/zxd/Documents/00-typora-md/知识点/2.执行上下文 作用域 闭包.assets/0655d18ec347a95dfbf843969a921a13.png)

从上图可以看出，输入一段代码，经过编译后，会生成两部分内容：**执行上下文（Execution context）**和**可执行代码**。

**执行上下文 （Execution context）是 JavaScript 执行一段代码时的运行环境,**也可以叫做**执行环境**

- 全局执行上下文

- 函数执行上下文

- eval执行上下文

  

执行上下文中又包含 

- **变量环境** （Variable Environment）
- **词法环境** （Lexical Environment）
- 外部环境  （outer）
- **this**

![img](/Users/zxd/Documents/00-typora-md/知识点/2.执行上下文 作用域 闭包.assets/b398610fd8060b381d33afc9b86f988d.png)

- 变量环境的对象（Viriable Environment）中保存了变量提升的内容

---

#### 执行阶段

生成了变量环境对象后， JS引擎会把声明以外的代码编译为字节码（可执行代码），之后进入执行阶段

JavaScript 引擎按照顺序一行一行地执行“可执行代码”。



#### 遇到同名变量或函数

如果代码中出现了重名的函数或者变量

```js
function showName() {
    console.log('极客邦');
}
showName();
function showName() {
    console.log('极客时间');
}
showName(); 
```

- 编译阶段，第二个showName会覆盖前一个， 变量对象中只存在第二个函数

- 执行阶段，两次都是调用第二个函数， 打印两次‘极客时间

  >  JavaScript 的执行机制：先编译，再执行。’



## 作用域

- **作用域是指在程序中定义变量的区域，该位置决定了变量的生命周期。**

- **作用域就是变量与函数的可访问范围，即作用域控制着变量和函数的可见性和生命周期。****

  

  

## 闭包

1. [JavaScript闭包的底层运行机制](http://blog.leapoahead.com/2015/09/15/js-closure/)

## 

## 参考



1. [面试官：说说作用域和闭包吧](https://juejin.cn/post/6844904165672484871#heading-19)

2. [JavaScript 的静态作用域链与“动态”闭包链](https://juejin.cn/post/6957913856488243237)
3. [JS 闭包经典使用场景和含闭包必刷题](https://juejin.cn/post/6937469222251560990)
4. [[核心概念] 一文说透 JS 中的执行上下文](https://juejin.cn/post/6890705692643196935)  good!
5. 极客时间专栏：浏览器工作原理与实践
6. [JavaScript深入之执行上下文栈](https://github.com/mqyqingfeng/Blog/issues/4) 
7. [一道js面试题引发的思考](https://github.com/kuitos/kuitos.github.io/issues/18)

![image-20211202202428125](/Users/zxd/Documents/00-typora-md/知识点/2. 作用域 闭包.assets/image-20211202202428125.png)


